<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pear App | Smart Team Sync</title>
    <meta name="description"
        content="Der intelligente Team-Organizer mit Echtzeit-Synchronisation f√ºr Termine und Kalender.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- PWA / Mobile Icon -->
    <link rel="icon" type="image/svg+xml" href="logo.svg">
    <link rel="apple-touch-icon" href="logo.svg">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0a0c10">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Firebase SDKs are loaded in app.js via modules or CDNs there if needed, 
         but here we use the CDN script tags for simplicity if not using bundler -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <link rel="stylesheet" href="style.css">

    <!-- FIX: Ensure map-pin icon works by including it if not already handled by lucide script -->
</head>

<body data-theme="dark">
    <!-- SPLASH SCREEN -->
    <div id="splash-screen"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #09090b; z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.6s ease-out, visibility 0.6s;">
        <svg width="120" height="120" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"
            style="filter: drop-shadow(0 0 20px rgba(255,255,255,0.2)); animation: pulse-logo 2s infinite;">
            <defs>
                <linearGradient id="rainbowGradSplash" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#FF0000;stop-opacity:1" />
                    <stop offset="16%" style="stop-color:#FF7F00;stop-opacity:1" />
                    <stop offset="33%" style="stop-color:#FFFF00;stop-opacity:1" />
                    <stop offset="50%" style="stop-color:#00FF00;stop-opacity:1" />
                    <stop offset="66%" style="stop-color:#0000FF;stop-opacity:1" />
                    <stop offset="83%" style="stop-color:#4B0082;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#8B00FF;stop-opacity:1" />
                </linearGradient>
                <mask id="biteMaskSplash">
                    <rect width="100" height="100" fill="white" />
                    <circle cx="78" cy="40" r="18" fill="black" />
                </mask>
            </defs>
            <path d="M50,10 C30,10 20,40 20,65 C20,90 35,95 50,95 C65,95 80,90 80,65 C80,40 70,10 50,10 Z"
                fill="url(#rainbowGradSplash)" mask="url(#biteMaskSplash)" />
            <path d="M50,10 Q50,0 60,5 C55,8 52,10 50,10" fill="url(#rainbowGradSplash)" />
        </svg>
        <h1
            style="margin-top: 20px; font-family: 'Outfit', sans-serif; font-weight: 700; color: white; letter-spacing: 1px;">
            Pear</h1>
    </div>

    <div id="app">
        <div class="sidebar-overlay" onclick="document.getElementById('sidebar').classList.remove('active')"></div>

        <!-- Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header mobile-only">
                <h3>Men√º</h3>
                <button class="close-sidebar" onclick="document.getElementById('sidebar').classList.remove('active')">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="logo">
                <svg class="logo-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="rainbowGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#FF0000;stop-opacity:1" />
                            <stop offset="16%" style="stop-color:#FF7F00;stop-opacity:1" />
                            <stop offset="33%" style="stop-color:#FFFF00;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#00FF00;stop-opacity:1" />
                            <stop offset="66%" style="stop-color:#0000FF;stop-opacity:1" />
                            <stop offset="83%" style="stop-color:#4B0082;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#8B00FF;stop-opacity:1" />
                        </linearGradient>
                        <mask id="biteMask">
                            <rect width="100" height="100" fill="white" />
                            <circle cx="78" cy="40" r="18" fill="black" />
                        </mask>
                    </defs>
                    <path d="M50,10 C30,10 20,40 20,65 C20,90 35,95 50,95 C65,95 80,90 80,65 C80,40 70,10 50,10 Z"
                        fill="url(#rainbowGrad)" mask="url(#biteMask)" />
                    <path d="M50,10 Q50,0 60,5 C55,8 52,10 50,10" fill="url(#rainbowGrad)" />
                </svg>
                <span id="sidebarAppName">Pear</span>
            </div>

            <div class="nav-items">
                <button class="nav-item active" data-page="dashboard" onclick="app.navigateTo('dashboard')">
                    <i data-lucide="layout-dashboard"></i> <span>Dashboard</span>
                </button>
                <button class="nav-item" data-page="calendar" onclick="app.navigateTo('calendar')">
                    <i data-lucide="calendar"></i> <span>Kalender</span>
                </button>
                <button class="nav-item" data-page="finance" onclick="app.navigateTo('finance')">
                    <i data-lucide="wallet"></i> <span>Finanzen</span>
                </button>
                <button class="nav-item" data-page="team" onclick="app.navigateTo('team')">
                    <i data-lucide="users"></i> <span>Team Sync</span>
                </button>
                <button class="nav-item" data-page="contacts" onclick="app.navigateTo('contacts')">
                    <i data-lucide="contact"></i> <span>Kontakte</span>
                </button>
                <button class="nav-item" data-page="todo" onclick="app.navigateTo('todo')">
                    <i data-lucide="check-square"></i> <span>Aufgaben</span>
                </button>
                <button class="nav-item" data-page="alarm" onclick="app.navigateTo('alarm')">
                    <i data-lucide="clock"></i> <span>Wecker</span>
                </button>
                <button class="nav-item" data-page="settings" onclick="app.navigateTo('settings')">
                    <i data-lucide="settings"></i> <span>Einstell.</span>
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <!-- Mobile Header with Hamburger -->
            <header class="top-bar mobile-only"
                style="justify-content: space-between; align-items: center; display: flex;">
                <button class="menu-toggle" onclick="document.getElementById('sidebar').classList.add('active')">
                    <i data-lucide="menu"></i>
                </button>

                <div style="display: flex; align-items: center;">
                    <button class="icon-btn" onclick="app.voice.start()" style="margin-right: 10px;">
                        <i data-lucide="mic"></i>
                    </button>
                    <div class="avatar" style="width: 40px; height: 40px;" onclick="app.navigateTo('settings')">
                        <img id="headerUserAvatarMobile" src="logo.svg"
                            style="width:100%; height:100%; object-fit:cover; border-radius:50%;">
                    </div>
                </div>
            </header>

            <header class="top-bar mobile-hidden">
                <div class="search-bar">
                    <i data-lucide="search"></i>
                    <input type="text" placeholder="Suche nach Terminen, Aufgaben...">
                </div>

                <div class="user-actions">
                    <button class="icon-btn" title="Sprachsteuerung" onclick="app.voice.start()">
                        <i data-lucide="mic"></i>
                    </button>
                    <!-- Notifications? -->

                    <div id="syncIndicator" class="sync-status-indicator" onclick="app.navigateTo('team')"
                        style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.05); padding: 6px 12px; border-radius: 20px; cursor: pointer; border: 1px solid var(--glass-border); margin-right: 15px;">
                        <span class="status-dot"
                            style="width: 8px; height: 8px; border-radius: 50%; background: #666;"></span>
                        <span id="syncStatusText"
                            style="font-size: 0.75rem; font-weight: 600; color: var(--text-muted);">Lokal</span>
                    </div>

                    <div class="user-info-mini"
                        style="display: flex; flex-direction: column; align-items: flex-end; margin-right: 10px;">
                        <span id="headerUserName" style="font-weight: 600; font-size: 0.9rem;">User</span>
                        <small class="text-muted" style="font-size: 0.7rem;">Organizer</small>
                    </div>
                    <div class="avatar" id="userAvatar">
                        <img id="headerUserAvatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=User"
                            alt="User">
                    </div>
                </div>
            </header>

            <!-- Views -->
            <section id="view-dashboard" class="page-view active">
                <div class="hero dashboard-hero" style="flex-direction: column; align-items: flex-start; gap: 20px;">
                    <div class="hero-info-pills"
                        style="display: flex; gap: 12px; width: 100%; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none;">
                        <div class="info-pill highlight" style="flex-shrink: 0;">
                            <i data-lucide="clock"></i>
                            <span id="dashClock">--:--</span>
                        </div>
                        <div class="info-pill highlight" style="flex-shrink: 0;">
                            <i data-lucide="calendar"></i>
                            <span id="dashDate">---, --. ---</span>
                        </div>
                        <div class="info-pill highlight mobile-hide-pill" style="flex-shrink: 0;">
                            <i data-lucide="map-pin"></i>
                            <span id="dashLocation">Ort...</span>
                        </div>
                        <div class="info-pill highlight mobile-hide-pill" style="flex-shrink: 0;">
                            <i data-lucide="cloud-sun"></i>
                            <span id="dashTemp">--¬∞C</span>
                        </div>
                    </div>

                    <div class="hero-main-row"
                        style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                        <div class="hero-text">
                            <h1 id="dashboardWelcomeTitle">Willkommen zur√ºck! üëã</h1>
                            <p>Hier ist eine √úbersicht deiner n√§chsten Termine.</p>
                        </div>
                        <button class="btn-hero-action animate-in"
                            onclick="app.openCreateAt(new Date().toISOString().split('T')[0])">
                            <div class="icon-circle">
                                <i data-lucide="calendar-plus"></i>
                            </div>
                            <div class="btn-label">
                                <span class="main-label">Neuer Termin</span>
                                <span class="sub-label">Schnell erfassen</span>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="card glass next-events collapsible-card">
                        <div class="card-header-toggle" onclick="app.toggleCard(this)">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <h3>N√§chste Termine</h3>
                                <i data-lucide="chevron-up" class="toggle-icon" size="20"></i>
                            </div>
                            <button class="btn-text" onclick="event.stopPropagation(); app.navigateTo('calendar')">Alle
                                ansehen</button>
                        </div>
                        <div class="event-list card-content" id="dashboardEventList">
                            <div class="empty-state">Lade Termine...</div>
                        </div>
                    </div>

                    <div class="card glass mini-calendar">
                        <div class="calendar-header">
                            <h3 id="miniCalendarMonth">Februar 2026</h3>
                        </div>
                        <div class="calendar-grid small" id="miniCalendarGrid">
                            <!-- JS populated -->
                        </div>
                    </div>


                </div>
            </section>

            <section id="view-calendar" class="page-view">
                <div class="calendar-container">
                    <!-- Calendar Sidebar -->
                    <aside class="calendar-sidebar glass">
                        <button class="btn-primary create-btn" id="sidebarCreateBtn">
                            <i data-lucide="plus"></i> Erstellen
                        </button>

                        <div class="mini-calendar-container">
                            <div class="mini-calendar-header">
                                <span id="sidebarMiniMonth">Februar 2026</span>
                                <div class="mini-nav">
                                    <button onclick="app.calendar.prevMini()"><i
                                            data-lucide="chevron-left"></i></button>
                                    <button onclick="app.calendar.nextMini()"><i
                                            data-lucide="chevron-right"></i></button>
                                </div>
                            </div>
                            <div class="calendar-grid small" id="sidebarMiniGrid">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <div class="calendar-filters">
                            <h4>Meine Kalender</h4>
                            <div class="filter-item">
                                <input type="checkbox" id="filter-work" checked>
                                <label for="filter-work"><span class="dot work"></span> Arbeit</label>
                            </div>
                            <div class="filter-item">
                                <input type="checkbox" id="filter-private" checked>
                                <label for="filter-private"><span class="dot private"></span> Privat</label>
                            </div>
                            <div class="filter-item">
                                <input type="checkbox" id="filter-urgent" checked>
                                <label for="filter-urgent"><span class="dot urgent"></span> Dringend</label>
                            </div>
                            <div class="filter-item">
                                <input type="checkbox" id="filter-birthday" checked>
                                <label for="filter-birthday"><span class="dot" style="background:#ffd700"></span>
                                    Geburtstage üéÇ</label>
                            </div>
                            <div class="filter-item">
                                <input type="checkbox" id="filter-holiday" checked>
                                <label for="filter-holiday"><span class="dot" style="background:#ff9f43"></span>
                                    Feiertage üéä</label>
                            </div>
                        </div>
                    </aside>

                    <!-- Main Calendar Area -->
                    <div class="calendar-main glass">
                        <header class="calendar-header-pro">
                            <div class="header-left">
                                <button class="btn-outline" onclick="app.calendar.goToday()">Heute</button>
                                <div class="nav-controls">
                                    <button id="prevMonth" class="icon-btn"><i data-lucide="chevron-left"></i></button>
                                    <button id="nextMonth" class="icon-btn"><i data-lucide="chevron-right"></i></button>
                                </div>
                                <h2 id="fullCalendarMonth">Februar 2026</h2>
                                <button class="icon-btn" id="monthLayoutToggle" onclick="app.toggleMonthLayout()"
                                    title="Ansicht wechseln" style="display:none; margin-left:10px;">
                                    <i data-lucide="grid"></i>
                                </button>
                            </div>
                            <div class="header-right">
                                <div class="view-selector" id="calendarViewSelector">
                                    <button data-view="day">Tag</button>
                                    <button data-view="week">Woche</button>
                                    <button data-view="month" class="active">Monat</button>
                                    <button data-view="year">Jahr</button>
                                </div>
                            </div>
                        </header>
                        <div class="calendar-body">
                            <div class="weekday-header" id="weekdayHeader">
                                <!-- Mo, Di, Mi... -->
                            </div>
                            <div class="calendar-grid-large" id="fullCalendarGrid">
                                <!-- Full calendar -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Finance View -->
            <section id="view-finance" class="page-view">
                <div class="hero">
                    <h1>Finanzplaner üí∞</h1>
                    <p>Behalte deine Ausgaben und dein Budget im Griff.</p>
                </div>

                <div class="dashboard-grid" style="grid-template-columns: repeat(4, 1fr); margin-bottom: 25px;">
                    <div class="card glass">
                        <small class="text-muted">Monatsausgaben</small>
                        <h2 id="finTotalIncome">0,00 ‚Ç¨</h2>
                    </div>
                    <div class="card glass">
                        <small class="text-muted">Monatsbudget</small>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <h2 id="finTotalBudget">0,00 ‚Ç¨</h2>
                            <button class="btn-icon" onclick="app.finance.editBudget()"><i data-lucide="edit-3"
                                    size="14"></i></button>
                        </div>
                    </div>
                    <div class="card glass">
                        <small class="text-muted">Verbleibendes Budget</small>
                        <h2 id="finRemaining">0,00 ‚Ç¨</h2>
                    </div>
                    <div class="card glass">
                        <small class="text-muted">Jahresausgaben</small>
                        <h2 id="finYearTotal">0,00 ‚Ç¨</h2>
                    </div>
                </div>

                <div class="card glass" style="margin-bottom: 25px; padding: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="trending-up" size="18" class="text-primary"></i>
                            <span style="font-weight: 600;">Kurz√ºbersicht (Tag/Woche)</span>
                        </div>
                        <button class="btn-text" style="font-size: 0.8rem;"
                            onclick="const x = document.getElementById('finExtraStats'); x.style.display = x.style.display === 'none' ? 'grid' : 'none'; this.textContent = x.style.display === 'none' ? 'Details anzeigen' : 'Details ausblenden'">Details
                            anzeigen</button>
                    </div>
                    <div id="finExtraStats" class="dashboard-grid"
                        style="grid-template-columns: 1fr 1fr; margin-top: 15px; display: none; gap: 15px;">
                        <div class="card glass" style="border: 1px solid var(--glass-border); padding: 15px;">
                            <small class="text-muted">Ausgaben heute</small>
                            <h3 id="finTodayTotal">0,00 ‚Ç¨</h3>
                        </div>
                        <div class="card glass" style="border: 1px solid var(--glass-border); padding: 15px;">
                            <small class="text-muted">Ausgaben diese Woche</small>
                            <h3 id="finWeekTotal">0,00 ‚Ç¨</h3>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="card glass">
                        <h3>Ausgabe hinzuf√ºgen</h3>
                        <form id="financeForm" onsubmit="app.finance.addEntry(event)" style="margin-top: 15px;">
                            <div class="form-row" style="display: flex; gap: 15px;">
                                <div class="form-group" style="flex: 1;">
                                    <label>Betrag (‚Ç¨)</label>
                                    <input type="number" id="finAmount" step="0.01" placeholder="0.00" required>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label>Datum</label>
                                    <input type="date" id="finDate" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Beschreibung / Zweck</label>
                                <input type="text" id="finSource" placeholder="z.B. Lebensmittel, Miete, Hobby...">
                            </div>
                            <button type="submit" class="btn-primary w-full">Eintragen</button>
                        </form>
                    </div>

                    <div class="card glass">
                        <h3>Ausgaben & Trends</h3>
                        <div style="height: 250px; position: relative;">
                            <canvas id="financeChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card glass" style="margin-top: 25px;">
                    <div class="card-header">
                        <h3>Transaktionsverlauf</h3>
                        <button class="btn-text" onclick="app.finance.clearAll()">Verlauf l√∂schen</button>
                    </div>
                    <div style="overflow-x: auto;">
                        <table class="contact-table">
                            <thead>
                                <tr>
                                    <th>Datum</th>
                                    <th>Zweck</th>
                                    <th>Betrag</th>
                                    <th style="width: 50px;"></th>
                                </tr>
                            </thead>
                            <tbody id="financeTableBody">
                                <!-- JS populated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="view-team" class="page-view">
                <div class="team-login-container" style="max-width: 500px; margin: 60px auto; text-align: center;">
                    <div class="card glass animate-in" style="padding: 40px;">
                        <div class="icon-circle"
                            style="width: 80px; height: 80px; background: rgba(var(--primary-rgb), 0.1); margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; border-radius: 50%; border: 2px solid var(--glass-border);">
                            <i data-lucide="cloud-lightning" size="32" style="color: var(--primary);"></i>
                        </div>
                        <h2>Team Login & Synchronisation</h2>
                        <p class="text-muted" style="margin-bottom: 30px;">Verbinde dich mit deinem Team, um deine Daten
                            in Echtzeit auf allen Ger√§ten zu synchronisieren.</p>

                        <div class="login-fields"
                            style="text-align: left; display: flex; flex-direction: column; gap: 20px;">
                            <div class="form-group">
                                <label style="margin-bottom: 8px; display: block; font-weight: 600;">Team-Schl√ºssel
                                    (Name)</label>
                                <input type="text" id="teamInput" placeholder="Z.B. MeinTeam2026"
                                    style="width: 100%; padding: 15px; background: #ffffff; color: #000000; border: 1px solid var(--glass-border); border-radius: 12px; font-size: 1.1rem;">
                            </div>
                            <div class="form-group">
                                <label style="margin-bottom: 8px; display: block; font-weight: 600;">Privat-PIN
                                    (4-stellig)</label>
                                <input type="password" id="teamPin" maxlength="4" placeholder="****"
                                    style="width: 100%; padding: 15px; background: #ffffff; color: #000000; border: 1px solid var(--glass-border); border-radius: 12px; font-size: 1.1rem; letter-spacing: 5px; text-align: center;">
                            </div>
                            <button class="btn-primary w-full" onclick="app.sync.connect()"
                                style="height: 55px; font-size: 1.1rem;">
                                <i data-lucide="shuffle"></i> Synchronisation Starten
                            </button>
                        </div>

                        <div id="activeSyncInfo" class="hidden"
                            style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--glass-border);">
                            <div
                                style="display: flex; align-items: center; justify-content: center; gap: 10px; color: var(--success); font-weight: 600; margin-bottom: 15px;">
                                <i data-lucide="check-circle" size="18"></i> Aktiv verbunden: <span
                                    id="currentTeamDisplay">---</span>
                            </div>
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button class="btn-outline" style="font-size: 0.85rem; padding: 8px 15px;"
                                    onclick="app.sync.push()">
                                    <i data-lucide="refresh-cw" size="14"></i> Jetzt abgleichen
                                </button>
                                <button class="btn-text" style="color: var(--danger); font-size: 0.85rem;"
                                    onclick="app.sync.disconnect()">Abmelden</button>
                            </div>
                        </div>
                    </div>

                    <div class="card glass animate-in" style="margin-top: 25px; padding: 25px; text-align: left;">
                        <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="info" size="18" style="color: var(--primary);"></i>
                            Wie funktioniert der Team-Sync?
                        </h4>
                        <ul
                            style="padding-left: 20px; color: var(--text-muted); font-size: 0.9rem; display: flex; flex-direction: column; gap: 8px;">
                            <li>Deine Daten werden sicher in der Cloud gespeichert.</li>
                            <li>W√§hle einen eindeutigen Team-Schl√ºssel.</li>
                            <li>Verwende den gleichen Schl√ºssel und PIN auf anderen Ger√§ten.</li>
                            <li>√Ñnderungen werden sofort auf allen angemeldeten Ger√§ten √ºbernommen.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="view-todo" class="page-view">
                <div class="hero">
                    <h1>Deine To-Do Liste üëã</h1>
                    <p>Plane deine Eink√§ufe und deinen Tag.</p>
                </div>

                <div class="todo-container glass animate-in" style="padding: 30px;">
                    <div class="todo-input-group"
                        style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px;">
                        <input type="text" id="todoInput"
                            style="width: 100%; height: 60px; font-size: 1.25rem; padding: 0 20px; border-radius: 16px; background: #ffffff; border: 2px solid var(--glass-border); color: #000000; transition: var(--transition);"
                            placeholder="Was steht an? (z.B. Milch kaufen, Mail schreiben...)"
                            onkeyup="if(event.key === 'Enter') app.todo.add()">

                        <div style="display: flex; gap: 10px; align-items: center;">
                            <div style="flex: 1; display: flex; gap: 8px;">
                                <select id="todoCategory"
                                    style="flex: 1; height: 50px; background: #ffffff; border: 1px solid var(--glass-border); border-radius: 12px; color: #000000; padding: 0 15px; font-weight: 500;">
                                    <!-- JS Populated -->
                                </select>
                                <button class="btn-outline" onclick="app.todo.addCategory()"
                                    style="height: 50px; width: 50px; border-radius: 12px; font-size: 1.5rem;"
                                    title="Neue Bezeichnung">+</button>
                            </div>
                            <button class="btn-primary" onclick="app.todo.add()"
                                style="height: 50px; padding: 0 30px; font-size: 1.1rem; border-radius: 12px;">
                                <i data-lucide="plus" size="20"></i> Hinzuf√ºgen
                            </button>
                        </div>
                    </div>

                    <div class="todo-filters" style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button class="filter-btn active btn-outline" data-filter="all"
                            onclick="app.todo.setFilter('all')">Alle</button>
                        <button class="filter-btn btn-outline" data-filter="active"
                            onclick="app.todo.setFilter('active')">Offen</button>
                        <button class="filter-btn btn-outline" data-filter="completed"
                            onclick="app.todo.setFilter('completed')">Erledigt</button>
                    </div>

                    <div id="todoList" class="todo-list"
                        style="margin: 20px 0; display: flex; flex-direction: column; gap: 10px;">
                        <!-- JS populated -->
                    </div>

                    <div class="todo-footer"
                        style="display: flex; justify-content: space-between; align-items: center; border-top: 1px solid var(--glass-border); padding-top: 15px;">
                        <span id="todoCount" class="text-muted">0 Aufgaben √ºbrig</span>
                        <button class="btn-text" onclick="app.todo.clearCompleted()">Erledigte l√∂schen</button>
                    </div>
                </div>
            </section>

            <section id="view-alarm" class="page-view">
                <div class="alarm-view-container glass animate-in" style="padding: 40px 20px;">
                    <div id="nightModeClock" class="digital-clock"
                        style="font-size: 5rem; font-weight: 700; color: var(--primary); text-shadow: 0 0 20px var(--primary); margin-bottom: 30px; font-family: var(--font-main, 'Outfit', sans-serif); text-align: center;">
                        00:00:00
                    </div>

                    <div style="max-width: 600px; margin: 0 auto;">
                        <div class="alarm-adder glass"
                            style="margin-bottom: 30px; padding: 20px; background: rgba(255,255,255,0.02);">
                            <h3 style="margin-bottom: 15px;">Neuen Wecker stellen</h3>
                            <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px;">
                                <input type="time" id="newAlarmTime"
                                    style="font-size: 1.2rem; padding: 10px; border-radius: 10px; background: #ffffff; color: #000000; border: 1px solid var(--glass-border);">
                                <button class="btn-primary" onclick="app.alarm.add()" style="flex: 1;">Hinzuf√ºgen
                                    ‚è∞</button>
                            </div>
                            <div class="day-selector" style="display: flex; justify-content: space-between; gap: 5px;">
                                <label class="day-chip"><input type="checkbox" value="1" checked><span>Mo</span></label>
                                <label class="day-chip"><input type="checkbox" value="2" checked><span>Di</span></label>
                                <label class="day-chip"><input type="checkbox" value="3" checked><span>Mi</span></label>
                                <label class="day-chip"><input type="checkbox" value="4" checked><span>Do</span></label>
                                <label class="day-chip"><input type="checkbox" value="5" checked><span>Fr</span></label>
                                <label class="day-chip"><input type="checkbox" value="6"><span>Sa</span></label>
                                <label class="day-chip"><input type="checkbox" value="0"><span>So</span></label>
                            </div>
                        </div>

                        <div id="alarmList" style="display: flex; flex-direction: column; gap: 15px;">
                            <!-- Alarms list -->
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px;">
                        <div class="glass" style="padding: 15px; text-align: center;">
                            <label
                                style="display: block; font-size: 0.8rem; margin-bottom: 10px; color: var(--text-muted);">Auto-Nachtuhr
                                ab:</label>
                            <input type="time" id="nightModeStart" onchange="app.alarm.saveSettings()"
                                style="background: #ffffff; border: 1px solid var(--glass-border); color: #000000; padding: 5px; border-radius: 5px;">
                        </div>
                        <div class="glass"
                            style="padding: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="wakeLockCheck" onchange="app.alarm.toggleWakeLock()">
                                <span style="font-size: 0.8rem;">Bildschirm anlassen üì±</span>
                            </label>
                        </div>
                    </div>

                    <div class="glass" style="margin-top: 15px; padding: 15px;">
                        <div
                            style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                            <label style="font-size: 0.9rem; color: var(--text-muted);">Helligkeit</label>
                            <input type="range" id="nightBrightness" min="0.1" max="1" step="0.1" value="1"
                                oninput="app.alarm.updateDesign('brightness', this.value)" style="width: 60%;">
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <label style="font-size: 0.9rem; color: var(--text-muted);">Farbe</label>
                            <div style="display:flex; gap:10px;">
                                <input type="color" id="nightColor" value="#ef4444"
                                    oninput="app.alarm.updateDesign('color', this.value)"
                                    style="background: transparent; border: none; height: 30px; width: 50px; cursor: pointer;">
                            </div>
                        </div>
                    </div>
                    <button class="btn-outline" onclick="app.alarm.toggleFullscreen()"
                        style="width: 100%; margin-top: 20px; padding: 15px;">
                        <i data-lucide="maximize" size="18"></i> Nachtuhr Modus (Vollbild)
                    </button>

                    <!-- Fullscreen Night Clock Overlay -->

            </section>

            <section id="view-settings" class="page-view">
                <div class="hero">
                    <h1>Einstellungen ‚öôÔ∏è</h1>
                    <p>Passe deinen MoltBot Organizer an.</p>
                </div>

                <div class="card glass animate-in collapsible-card is-collapsed" style="margin-bottom: 25px;">
                    <div class="card-header-toggle" onclick="app.toggleCard(this)">
                        <h3>Mein Profil üë§</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="card-content">
                        <div class="profile-setup"
                            style="display: flex; gap: 20px; align-items: center; margin-bottom: 25px;">
                            <div id="avatarPreviewContainer" class="avatar-large"
                                style="position: relative; width: 100px; height: 100px; cursor: pointer; flex-shrink: 0;"
                                onclick="document.getElementById('userAvatarUpload').click()">
                                <img id="settingsUserAvatarPreview" src="logo.svg"
                                    style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; border: 3px solid var(--primary);">
                                <div
                                    style="position: absolute; bottom: 0; right: 0; background: var(--primary); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid var(--bg-card);">
                                    <i data-lucide="camera" size="14"></i>
                                </div>
                                <input type="file" id="userAvatarUpload" hidden accept="image/*"
                                    onchange="app.handleAvatarUpload(this)">
                            </div>
                            <div>
                                <h4 style="margin: 0 0 5px 0;">Profilbild</h4>
                                <p class="text-muted" style="font-size: 0.8rem; margin: 0;">Klicke auf das Bild, um ein
                                    neues Foto hochzuladen oder √§ndere deinen Namen f√ºr einen neuen Avatar.</p>
                            </div>
                        </div>
                        <p class="text-muted" style="margin-bottom: 15px;">Passe deine pers√∂nlichen Informationen an.
                        </p>
                        <div class="settings-input-grid">
                            <div class="input-group">
                                <label>Dein Name</label>
                                <input type="text" id="settingsUserName" placeholder="Name eingeben..."
                                    onchange="app.updateUserName(this.value)">
                            </div>
                            <div class="input-group">
                                <label>Geburtsdatum</label>
                                <input type="date" id="settingsUserBirthday"
                                    onchange="app.updateUserData('birthday', this.value)">
                            </div>
                            <div class="input-group">
                                <label>Telefon</label>
                                <input type="tel" id="settingsUserPhone" placeholder="Telefonnummer..."
                                    onchange="app.updateUserData('phone', this.value)">
                            </div>
                            <div class="input-group">
                                <label>E-Mail</label>
                                <input type="email" id="settingsUserEmail" placeholder="E-Mail..."
                                    onchange="app.updateUserData('email', this.value)">
                            </div>
                        </div>
                        <div class="input-group" style="margin-top: 15px;">
                            <label>Adresse</label>
                            <input type="text" id="settingsUserAddress" placeholder="Deine Adresse..."
                                onchange="app.updateUserData('address', this.value)">
                        </div>
                        <div
                            style="margin-top: 25px; padding-top: 15px; border-top: 1px solid var(--glass-border); display: flex; justify-content: flex-end;">
                            <button class="icon-btn-subtle" onclick="app.resetUserProfile()"
                                style="color: var(--danger); gap: 8px; border-radius: 8px; padding: 10px 15px; font-weight: 600;">
                                <i data-lucide="refresh-cw" size="16"></i> Profil zur√ºcksetzen
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card glass animate-in collapsible-card is-collapsed" style="margin-bottom: 25px;">
                    <div class="card-header-toggle" onclick="app.toggleCard(this)">
                        <h3>Erscheinungsbild üé®</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="card-content">


                        <p class="text-muted" style="margin-bottom: 15px;">W√§hle das Design, das dir am besten gef√§llt.
                        </p>
                        <div class="theme-selector-grid"
                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                            <button class="theme-btn" data-theme="dark" onclick="app.updateTheme('dark')">
                                <div class="theme-preview dark"></div>
                                <span>Dunkel</span>
                            </button>
                            <button class="theme-btn" data-theme="light" onclick="app.updateTheme('light')">
                                <div class="theme-preview light"></div>
                                <span>Hell</span>
                            </button>
                            <button class="theme-btn" data-theme="gold" onclick="app.updateTheme('gold')">
                                <div class="theme-preview gold" style="background: #d4af37;"></div>
                                <span>Gold</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card glass animate-in collapsible-card is-collapsed" style="margin-bottom: 25px;">
                    <div class="card-header-toggle" onclick="app.toggleCard(this)">
                        <h3>Bildschirm & Anpassung üëÅÔ∏è</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="card-content">
                        <p class="text-muted" style="margin-bottom: 20px;">Passe Schriftart, Farben und Kontrast f√ºr
                            bessere Lesbarkeit an.</p>

                        <div class="settings-input-grid">
                            <div class="form-group">
                                <label>Schriftart</label>
                                <select id="settingsFont" onchange="app.updateVisualSetting('customFont', this.value)"
                                    style="width: 100%; padding: 12px; background: #ffffff; border: 1px solid var(--glass-border); border-radius: 12px; color: #000000;">
                                    <option value="Outfit">Standard (Outfit)</option>
                                    <option value="System">System (Arial/Helvetica)</option>
                                    <option value="Serif">Serif (Times/Georgia)</option>
                                    <option value="Mono">Monospace (Code)</option>
                                    <option value="Dyslexic">Open Dyslexic (Lesehilfe)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Hauptfarbe (Elemente)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <input type="color" id="settingsPrimaryColor"
                                        oninput="app.updateVisualSetting('customPrimary', this.value)"
                                        style="height: 45px; width: 100%; cursor: pointer; background: transparent; border: none;">
                                    <button class="btn-outline"
                                        onclick="app.updateVisualSetting('customPrimary', ''); document.getElementById('settingsPrimaryColor').value='#a1a1aa';"
                                        title="Zur√ºcksetzen">
                                        <i data-lucide="rotate-ccw"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Hintergrund-Farbe (Bereich)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <input type="color" id="settingsSecondaryColor"
                                        oninput="app.updateVisualSetting('customSecondary', this.value)"
                                        style="height: 45px; width: 100%; cursor: pointer; background: transparent; border: none;">
                                    <button class="btn-outline"
                                        onclick="app.updateVisualSetting('customSecondary', ''); document.getElementById('settingsSecondaryColor').value='#52525b';"
                                        title="Zur√ºcksetzen">
                                        <i data-lucide="rotate-ccw"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="form-group"
                                style="grid-column: 1 / -1; display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="settingsHighContrast"
                                    onchange="app.updateVisualSetting('highContrastMode', this.checked)"
                                    style="width: 20px; height: 20px;">
                                <label for="settingsHighContrast">Einfacher Lesemodus (Maximaler Kontrast)</label>
                            </div>

                            <div class="form-group"
                                style="grid-column: 1 / -1; display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="settingsBoldMode"
                                    onchange="app.updateVisualSetting('boldMode', this.checked)"
                                    style="width: 20px; height: 20px;">
                                <label for="settingsBoldMode"><b>Fetter Text (Alles hervorheben)</b></label>
                            </div>
                        </div>

                        <div style="margin-top: 20px; display: flex; flex-direction: column; gap: 20px;">
                            <div class="range-group">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <label>S√§ttigung</label>
                                    <span id="labelSat">100%</span>
                                </div>
                                <input type="range" id="inputSat" min="0" max="200" value="100"
                                    oninput="document.getElementById('labelSat').textContent = this.value + '%'; app.updateVisualSetting('globalSaturation', this.value)"
                                    style="width: 100%;">
                            </div>

                            <div class="range-group">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <label>Kontrast</label>
                                    <span id="labelCon">100%</span>
                                </div>
                                <input type="range" id="inputCon" min="50" max="200" value="100"
                                    oninput="document.getElementById('labelCon').textContent = this.value + '%'; app.updateVisualSetting('globalContrast', this.value)"
                                    style="width: 100%;">
                            </div>

                            <div class="range-group">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <label>Helligkeit</label>
                                    <span id="labelBri">100%</span>
                                </div>
                                <input type="range" id="inputBri" min="50" max="150" value="100"
                                    oninput="document.getElementById('labelBri').textContent = this.value + '%'; app.updateVisualSetting('globalBrightness', this.value)"
                                    style="width: 100%;">
                            </div>

                            <div class="range-group">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <label>Schriftgr√∂√üe</label>
                                    <span id="labelFontScale">100%</span>
                                </div>
                                <input type="range" id="inputFontScale" min="70" max="150" value="100"
                                    oninput="document.getElementById('labelFontScale').textContent = this.value + '%'; app.updateVisualSetting('fontSizeScale', this.value)"
                                    style="width: 100%;">
                            </div>

                            <button class="btn-outline" onclick="app.resetVisuals()"
                                style="margin-top: 15px; border-color: var(--danger); color: var(--danger);">
                                <i data-lucide="rotate-ccw"></i> Einstellungen zur√ºcksetzen
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card glass animate-in collapsible-card is-collapsed">
                    <div class="card-header-toggle" onclick="app.toggleCard(this)">
                        <h3>Listen & Bezeichnungen</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="card-content">
                        <p class="text-muted" style="margin-bottom: 15px;">Hier kannst du deine Bezeichnungen f√ºr
                            Aufgaben
                            verwalten und l√∂schen.</p>
                        <div id="categoryManager"
                            style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
                            <!-- JS Populated -->
                        </div>
                    </div>
                </div>

                <div class="card glass animate-in collapsible-card is-collapsed" style="margin-top: 25px;">
                    <div class="card-header-toggle" onclick="app.toggleCard(this)">
                        <h3>Feiertage (BW) üá©üá™</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="card-content">
                        <p class="text-muted" style="margin-bottom: 15px;">Automatisch berechnete Feiertage f√ºr das
                            aktuelle Jahr.</p>
                        <div id="settingsHolidayList" style="display: flex; flex-direction: column; gap: 8px;">
                            <!-- JS Populated -->
                        </div>
                    </div>
                </div>

                <div class="card glass animate-in collapsible-card is-collapsed" style="margin-top: 25px;">
                    <div class="card-header-toggle" onclick="app.toggleCard(this)">
                        <h3>Schnellzugriff & Dock üöÄ</h3>
                        <i data-lucide="chevron-down" class="toggle-icon"></i>
                    </div>
                    <div class="card-content">
                        <p class="text-muted" style="margin-bottom: 20px;">W√§hle dein bevorzugtes Design f√ºr die untere
                            Steuerungsleiste.</p>

                        <div class="settings-input-grid" style="margin-bottom: 20px;">
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label>Dock Modus</label>
                                <select id="settingsDockStyle" onchange="app.updateDockStyle(this.value)">
                                    <option value="compact">Kompakt (3 Buttons)</option>
                                    <option value="full">Vollst√§ndig (Alle Module)</option>
                                </select>
                            </div>
                        </div>

                        <div id="quickActionSettings" class="settings-input-grid">
                            <div class="form-group">
                                <label>Linker Button</label>
                                <select id="settingsQALeft" onchange="app.updateQuickAction('Left', this.value)">
                                    <option value="dashboard">Dashboard</option>
                                    <option value="calendar">Kalender</option>
                                    <option value="finance">Finanzen</option>
                                    <option value="team">Team Sync</option>
                                    <option value="contacts">Kontakte</option>
                                    <option value="todo">Aufgaben</option>
                                    <option value="alarm">Wecker</option>
                                    <option value="settings">Einstellungen</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Rechter Button</label>
                                <select id="settingsQARight" onchange="app.updateQuickAction('Right', this.value)">
                                    <option value="dashboard">Dashboard</option>
                                    <option value="calendar">Kalender</option>
                                    <option value="finance">Finanzen</option>
                                    <option value="team">Team Sync</option>
                                    <option value="contacts">Kontakte</option>
                                    <option value="todo">Aufgaben</option>
                                    <option value="alarm">Wecker</option>
                                    <option value="settings">Einstellungen</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="view-contacts" class="page-view">
                <div class="hero">
                    <h1>Meine Kontakte üë•</h1>
                    <p>Verwalte deine Freunde und Familie.</p>
                </div>

                <div class="quick-contacts-bar glass animate-in" style="margin-bottom: 20px; padding: 15px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <h4
                            style="font-size: 0.8rem; text-transform: uppercase; color: var(--text-muted); letter-spacing: 1px; margin: 0;">
                            Favoriten ‚ù§Ô∏è</h4>
                        <button class="icon-btn" id="toggleFavsBtn" onclick="app.toggleFavorites()"
                            style="width: 24px; height: 24px;">
                            <i data-lucide="chevron-up"></i>
                        </button>
                    </div>
                    <div class="quick-contact-grid" id="quickContactsContainer">
                        <!-- JS Populated -->
                    </div>
                </div>

                <div class="glass animate-in" style="margin-bottom: 20px; padding: 20px;">
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <div class="search-bar" style="flex: 1; min-width: 250px;">
                            <i data-lucide="search"></i>
                            <input type="text" id="contactSearch" placeholder="Kontakte suchen..."
                                oninput="app.contacts.render()">
                        </div>
                        <div class="view-selector" id="contactViewSelector">
                            <button data-view="cards" title="Kartenansicht"><i data-lucide="layout-grid"></i></button>
                            <button data-view="table" title="Listenansicht"><i data-lucide="list"></i></button>
                        </div>
                        <button class="btn-primary" onclick="app.contacts.openModal()">
                            <i data-lucide="user-plus"></i> Hinzuf√ºgen
                        </button>

                        <details style="position: relative;">
                            <summary class="btn-outline"
                                style="list-style: none; display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <i data-lucide="download"></i> Import & Sync <i data-lucide="chevron-down"
                                    size="14"></i>
                            </summary>
                            <div class="glass"
                                style="position: absolute; top: 120%; right: 0; padding: 15px; display: flex; flex-direction: column; gap: 10px; min-width: 220px; z-index: 50; border: 1px solid rgba(255,255,255,0.1);">
                                <button class="btn-outline"
                                    onclick="this.closest('details').removeAttribute('open'); app.sync.push()"
                                    title="Jetzt manuell synchronisieren"
                                    style="justify-content: flex-start; width: 100%;">
                                    <i data-lucide="refresh-cw"></i> Cloud Sync
                                </button>
                                <label class="btn-outline"
                                    style="display: flex; align-items: center; gap: 8px; cursor: pointer; justify-content: flex-start; width: 100%;">
                                    <i data-lucide="file-input"></i> Datei (VCF/CSV)
                                    <input type="file" id="contactImportFile" accept=".vcf,.csv" style="display: none;"
                                        onchange="this.closest('details').removeAttribute('open'); app.contacts.import(this)">
                                </label>
                                <button class="btn-outline mobile-only"
                                    onclick="this.closest('details').removeAttribute('open'); app.contacts.importMobile()"
                                    style="justify-content: flex-start; width: 100%;">
                                    <i data-lucide="smartphone"></i> Handy Import
                                </button>
                            </div>
                        </details>
                    </div>
                </div>

                <div id="contactMainContainer" class="animate-in">
                    <!-- Populated by JS as either table or cards -->
                </div>
            </section>
        </main> <!-- End of Main Content -->

        <!-- Modals -->
        <div class="modal-overlay hidden" id="modalOverlay">
            <div class="modal glass">
                <div class="modal-header">
                    <h2 id="modalTitle">Neuer Termin</h2>
                    <button class="close-modal" id="closeModalBtn"><i data-lucide="x"></i></button>
                </div>
                <div class="modal-body">
                    <form id="eventForm">
                        <div class="form-group">
                            <label>Titel</label>
                            <input type="text" id="eventTitle" placeholder="Meeting, Arzt, Sport..." required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Datum</label>
                                <input type="date" id="eventDate" required>
                            </div>
                            <div class="form-group">
                                <label>Uhrzeit</label>
                                <input type="time" id="eventTime">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ort / Adresse</label>
                            <input type="text" id="eventLocation" placeholder="M√ºnchen, Marienplatz...">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Telefon</label>
                                <input type="tel" id="eventPhone" placeholder="+49...">
                            </div>
                            <div class="form-group">
                                <label>E-Mail</label>
                                <input type="email" id="eventEmail" placeholder="kontakt@beispiel.de">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notizen</label>
                            <textarea id="eventNotes" placeholder="Details zum Termin..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <label>Kategorie</label>
                                <select id="eventCategory">
                                    <option value="work">Arbeit</option>
                                    <option value="private">Privat</option>
                                    <option value="urgent">Dringend</option>
                                    <option value="birthday">Geburtstag üéÇ</option>
                                    <option value="holiday">Feiertag üéä</option>
                                    <option value="reminder">Erinnerung</option>
                                </select>
                            </div>
                            <div class="form-group" style="width: 80px;">
                                <label>Farbe</label>
                                <input type="color" id="eventColor" value="#6366f1"
                                    style="height: 42px; width: 100%; padding: 2px; cursor: pointer;">
                            </div>
                        </div>
                        <button type="submit" class="btn-primary w-full">Speichern</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Exit Confirmation Modal -->
        <div class="modal-overlay hidden" id="exitModalOverlay">
            <div class="modal glass" style="max-width: 400px; text-align: center; padding: 40px 30px;">
                <div style="margin-bottom: 25px;">
                    <div class="icon-circle"
                        style="width: 80px; height: 80px; background: rgba(var(--primary-rgb), 0.1); margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; border-radius: 50%; border: 2px solid var(--glass-border);">
                        <i data-lucide="log-out" size="32" style="color: var(--primary);"></i>
                    </div>
                    <h2 style="font-size: 1.5rem; margin-bottom: 10px;">App beenden?</h2>
                    <p class="text-muted">M√∂chtest du Pear wirklich verlassen?</p>
                </div>
                <div style="display: flex; gap: 15px;">
                    <button class="btn-outline" style="flex: 1; justify-content: center;"
                        onclick="app.closeExitModal()">Abbrechen</button>
                    <button class="btn-primary"
                        style="flex: 1; justify-content: center; background: var(--danger); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);"
                        onclick="app.confirmExit()">Beenden</button>
                </div>
            </div>
        </div>
        <!-- Contact Modal -->
        <div class="modal-overlay hidden" id="contactModalOverlay">
            <div class="modal glass">
                <div class="modal-header">
                    <h2 id="contactModalTitle">Kontakt hinzuf√ºgen</h2>
                    <button class="close-modal" id="closeContactModalBtn"><i data-lucide="x"></i></button>
                </div>
                <div class="modal-body">
                    <form id="contactForm">
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" id="contactName" placeholder="Max M√ºller" required>
                        </div>
                        <div class="form-group">
                            <label>Telefon</label>
                            <input type="tel" id="contactPhone" placeholder="+49 123 456789">
                        </div>
                        <div class="form-group">
                            <label>E-Mail</label>
                            <input type="email" id="contactEmail" placeholder="max@beispiel.de">
                        </div>
                        <div class="form-group">
                            <label>Adresse</label>
                            <input type="text" id="contactAddress" placeholder="Musterstra√üe 1, Berlin">
                        </div>
                        <div class="form-group">
                            <label>Geburtsdatum</label>
                            <input type="date" id="contactBirthday">
                        </div>
                        <div class="form-group">
                            <label>Notizen</label>
                            <textarea id="contactNotes" placeholder="Zus√§tzliche Infos..."
                                style="height: 60px;"></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="contactIsFavorite" style="width: auto;">
                                Favorit ‚ù§Ô∏è (Wird oben angepinnt)
                            </label>
                        </div>
                        <button type="submit" class="btn-primary w-full">Kontakt Speichern</button>
                    </form>
                </div>
            </div>
        </div>
        <!-- Hamburger Menu is now the primary mobile navigation -->

        <!-- Bottom Navigation Bar (Mobile & Tablet) -->
        <div class="voice-dock">
            <button id="qaLeftBtn" class="voice-side-btn left" onclick="app.navigateTo(app.state.quickActionLeft)">
                <i data-lucide="layout-dashboard"></i>
            </button>
            <button id="voiceControlBtn" class="voice-btn" onclick="app.voice.start()">
                <i data-lucide="mic"></i>
            </button>
            <button id="qaRightBtn" class="voice-side-btn right" onclick="app.navigateTo(app.state.quickActionRight)">
                <i data-lucide="settings"></i>
            </button>
        </div>

        <!-- Pear AI Voice & Intelligence Overlay -->
        <div id="voiceOverlay" class="voice-overlay hidden">
            <div class="ai-orb-container">
                <div class="ai-orb"></div>
                <div class="ai-orb-blur"></div>
            </div>

            <div class="voice-content ai-premium-content">
                <div class="ai-badge">PEAR AI ASSISTANT</div>
                <h2 id="aiStatusTitle">Wie kann ich dir helfen?</h2>

                <div class="transcript-container glass">
                    <p id="voiceTranscript" class="transcript">Sage z.B. "Erinnere mich an das Meeting morgen" oder "Wie
                        ist mein Budget?"</p>
                </div>

                <div class="ai-visualizer">
                    <div class="ai-bar"></div>
                    <div class="ai-bar"></div>
                    <div class="ai-bar"></div>
                    <div class="ai-bar"></div>
                    <div class="ai-bar"></div>
                </div>

                <div class="ai-controls">
                    <button class="btn-outline ai-btn-close" onclick="app.voice.stop()">
                        <i data-lucide="x" size="20"></i> Schlie√üen
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- Fullscreen Night Clock Overlay (Moved to root level) -->
    <div id="nightClockFullscreen" class="night-overlay hidden" onclick="app.alarm.toggleFullscreen()">
        <div class="night-clock-large" id="fullscreenClock">00:00</div>
        <div class="night-clock-date" id="fullscreenDate">Freitag, 6. Februar</div>

        <!-- Controls visible on hover/tap -->
        <div class="night-controls" onclick="event.stopPropagation()">
            <div class="control-group">
                <i data-lucide="sun" size="16"></i>
                <input type="range" id="fsBrightness" min="0.1" max="1" step="0.1"
                    oninput="app.alarm.updateDesign('brightness', this.value)">
            </div>
            <div class="control-group">
                <i data-lucide="palette" size="16"></i>
                <input type="color" id="fsColor" oninput="app.alarm.updateDesign('color', this.value)">
            </div>
        </div>

        <div class="night-hint">Tippen zum Beenden</div>
    </div>

    </div> <!-- End of #app -->

    <script src="app.js"></script>
</body>

</html>